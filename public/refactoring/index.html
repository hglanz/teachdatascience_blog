<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Teaching refactoring to improve code  &middot; Teach Data Science</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="R Markdown, refactoring, style, code smell, smell, functions, ">


<meta property="og:title" content="Teaching refactoring to improve code  &middot; Teach Data Science ">
<meta property="og:site_name" content="Teach Data Science"/>
<meta property="og:url" content="/refactoring/" />
<meta property="og:locale" content="en">

<meta property="content-source" content="post\2019_07_08_Refactoring\refactoring.html">
<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2019-07-07T00:00:00Z" />
<meta property="og:article:modified_time" content="2019-07-07T00:00:00Z" />

  
    
<meta property="og:article:tag" content="R Markdown">
    
<meta property="og:article:tag" content="refactoring">
    
<meta property="og:article:tag" content="style">
    
<meta property="og:article:tag" content="code smell">
    
<meta property="og:article:tag" content="smell">
    
<meta property="og:article:tag" content="functions">
    
  

  

  



<link rel="canonical" href="/refactoring/" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
<link rel="icon" href="/favicon.png">
<meta name="generator" content="Hugo 0.55.5" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->




    
    








    
    




    



<link rel="stylesheet" href="/css/bundle.min.9cecddc0b0a806321dce2745c30cd884bab99ef1359b5380fd4eebe290bb48ce7d3bd9e879986198c555a3b400fc233603177172e60fb4652500b61c152c4034.css" >

</head>
<body data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
    <header id="main-header">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        
          
          <a class="navbar-brand-img" href="/">
            <img alt="Teach Data Science" src="https://raw.githubusercontent.com/hglanz/DS-Blog-Ex-Test/master/teachdslogosnip2.png">
            
          </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            
            
            <li class="">
              
		<a href="/about/"  title="About">
                  <i class='fa fa-road'></i>
                  About
                </a>
              
            </li>
            
            <li class="">
              
		<a href="/post/"  title="Blog">
                  
                  Blog
                </a>
              
            </li>
            
            <li class="">
              
		<a href="/tags/"  title="Tags">
                  
                  Tags
                </a>
              
            </li>
            
            
              
          </ul>
        </div>
        
      </div>
    </nav>
  </header>





<div class="container">
  <div class="row">
    <div class="col-sm-9">


      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
  <div class="title-metas text-center">

    <h1>Teaching refactoring to improve code
</h1>

    <div class="metas">
<small>
  <i class="fa fa-calendar"></i>
  <time datetime="2019-07-07">7 Jul, 2019</time>
</small>


  <small>
    &middot; by Nicholas Horton
  
  &middot; Read in about 4 min
  &middot; (640 words)
  &middot; 
<span class="share-box">Share this on:
    <a href="https://www.facebook.com/sharer/sharer.php?u=%2frefactoring%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-facebook-official "></i></a>

    <a href="https://twitter.com/intent/tweet?text=Teaching%20refactoring%20to%20improve%20code&amp;url=%2frefactoring%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-twitter"></i></a>

    <a href="https://plus.google.com/share?url=%2frefactoring%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-google-plus"></i></a>

    <a href="http://www.reddit.com/submit?url=%2frefactoring%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-reddit"></i></a>

    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2frefactoring%2f&amp;title=Teaching%20refactoring%20to%20improve%20code" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-linkedin"></i></a>

    <a href="mailto:?subject=Teaching%20refactoring%20to%20improve%20code&amp;body=Check out this site %2frefactoring%2f" data-proofer-ignore=""><i class="fa fa-envelope"></i></a>
  </span>

  </small>

<div class="margin-10">
  <i class="fa fa-tags"></i>
  
  <a href="/tags/r-markdown" class="label label-primary">R Markdown</a>
  
  <a href="/tags/refactoring" class="label label-primary">refactoring</a>
  
  <a href="/tags/style" class="label label-primary">style</a>
  
  <a href="/tags/code-smell" class="label label-primary">code smell</a>
  
  <a href="/tags/smell" class="label label-primary">smell</a>
  
  <a href="/tags/functions" class="label label-primary">functions</a>
  


</div>

<br>
</div>

  </div>
</div>


      <div class="content">
  


<p>A previous entry discussed the importance of <a href="https://teachdatascience.com/codingstyle">coding style and “code smell”</a> to help data analyses be clearer and more comprehensible. In this entry we will extend that discussion to describe ways of teaching code refactoring.</p>
<p><a href="https://en.wikipedia.org/wiki/Code_refactoring">Wikipedia</a> defines code refactoring as “the process of restructuring existing computer code—changing the factoring—without changing its external behavior. Refactoring is intended to improve nonfunctional attributes of the software. Advantages include improved code readability and reduced complexity; these can improve source-code maintainability and create a more expressive internal architecture or object model to improve extensibility.”</p>
<p>The goal is then to make code 1) easier to understand and 2) modified without changing the underlying behavior</p>
<p>Jenny Bryan defines refactoring structures in code that suggest (or as she says, screams for) refactoring. As we have done <a href="https://teachdatascience.com/screencast">before</a>, we will encourage you and your students to watch her excellent <a href="https://www.youtube.com/watch?v=7oyiPBjLAWY">keynote address from UseR 2018</a>. In her typical useful fashion, a <a href="https://github.com/jennybc/code-smells-and-feels">github repo</a> contains a link to the video, slides, and files mentioned in the talk.</p>
<p>Her sound advice includes:</p>
<ol style="list-style-type: decimal">
<li>never use attach() (or setwd()!)</li>
<li>add a space before and after =</li>
<li>“have better taste”</li>
<li>write more elegant code</li>
</ol>
<p>Jenny introduces the idea of a <a href="https://en.wikipedia.org/wiki/Code_smell"><em>code smell</em></a> as a signal that more elegant code is needed (and it’s time to refactor). In her talk, she describes how writing elegant code is particularly challenging for new programmers and analysts since their “taste develops faster than their ability”.</p>
<p>She provides several motivating examples, beginning with the <code>bizarro()</code> function. Here’s another function where considerable error checking is undertaken.</p>
<p>The <strong>BEFORE</strong> version works just fine, but it is criticized as being much harder to comprehend.</p>
<pre><code>get_some_data &lt;- function(config, outfile) {
  if (config_ok(config)) {
    if (can_write(outfile)) {
      if (can_open_network_connection(config)) {
        data &lt;- parse_something_from_network()
        if(makes_sense(data)) {
          data &lt;- beautify(data)
          write_it(data, outfile)
          return(TRUE)
        } else {
          return(FALSE)
        }
      } else {
        stop(&quot;Can&#39;t access network&quot;)
      }
    } else {
      ## uhm. What was this else for again?
    }
  } else {
    ## maybe, some bad news about ... the config? 
  }
}</code></pre>
<p>The <strong>AFTER</strong> version has the same functionality but is simpler to understand and boasts far less indentation.</p>
<pre><code>get_some_data &lt;- function(config, outfile) {
  if (config_bad(config)) {
    stop(&quot;Bad config&quot;)
  }
  
  if (!can_write(outfile)) {
    stop(&quot;Can&#39;t write outfile&quot;)
  }
  
  if (!can_open_network_connection(config)) {
    stop(&quot;Can&#39;t access network&quot;)
  }
  
  data &lt;- parse_something_from_network()
  if(!makes_sense(data)) {
    return(FALSE)
  }
  
  data &lt;- beautify(data)
  write_it(data, outfile)
  TRUE
}</code></pre>
<p>Jenny’s advice:</p>
<ol style="list-style-type: decimal">
<li>use if() else() in moderation</li>
<li>use functions</li>
<li>use guard clauses</li>
<li>clarify the “happy path”</li>
</ol>
<p>Aspects of programming style differ but key principles exist and it behooves us to introduce students to them. We found her talk really helpful in thinking about how to introduce higher-level aspects of algorithmic thinking in data science courses. Your summer reading list might includes several refactoring books, including <a href="https://en.wikipedia.org/wiki/Martin_Fowler_(software_engineer)">Martin Fowler’s</a> “Refactoring: Improving the Design of Existing Code” and the second edition of Hadley Wickham’s <a href="https://adv-r.hadley.nz">Advanced R</a> book.</p>
<div id="learn-more" class="section level3">
<h3>Learn more</h3>
<ul>
<li><a href="https://github.com/jennybc/code-smells-and-feels" class="uri">https://github.com/jennybc/code-smells-and-feels</a> (Code smells and feels keynote materials)</li>
<li><a href="https://en.wikipedia.org/wiki/Code_refactoring" class="uri">https://en.wikipedia.org/wiki/Code_refactoring</a> (Code refactoring)</li>
<li><a href="https://en.wikipedia.org/wiki/Code_smell" class="uri">https://en.wikipedia.org/wiki/Code_smell</a> (Code smells)</li>
<li><a href="https://adv-r.hadley.nz" class="uri">https://adv-r.hadley.nz</a> (Advanced R, second edition)</li>
<li><a href="https://en.wikipedia.org/wiki/Martin_Fowler_(software_engineer)" class="uri">https://en.wikipedia.org/wiki/Martin_Fowler_(software_engineer)</a> (Martin Fowler)</li>
</ul>
</div>
<div id="about-this-blog" class="section level3">
<h3>About this blog</h3>
<p>Each day during the summer of 2019 we intend to add a new entry to this blog on a given topic of interest to educators teaching data science and statistics courses. Each entry is intended to provide a short overview of why it is interesting and how it can be applied to teaching. We anticipate that these introductory pieces can be digested daily in 20 or 30 minute chunks that will leave you in a position to decide whether to explore more or integrate the material into your own classes. By following along for the summer, we hope that you will develop a clearer sense for the fast moving landscape of data science. Sign up for emails at <a href="https://groups.google.com/forum/#!forum/teach-data-science" class="uri">https://groups.google.com/forum/#!forum/teach-data-science</a> (you must be logged into Google to sign up).</p>
<p>We always welcome comments on entries and suggestions for new ones.</p>
</div>

</div>


      <footer>
  
<span class="share-box">Share this on:
    <a href="https://www.facebook.com/sharer/sharer.php?u=%2frefactoring%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-facebook-official "></i></a>

    <a href="https://twitter.com/intent/tweet?text=Teaching%20refactoring%20to%20improve%20code&amp;url=%2frefactoring%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-twitter"></i></a>

    <a href="https://plus.google.com/share?url=%2frefactoring%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-google-plus"></i></a>

    <a href="http://www.reddit.com/submit?url=%2frefactoring%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-reddit"></i></a>

    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=%2frefactoring%2f&amp;title=Teaching%20refactoring%20to%20improve%20code" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-linkedin"></i></a>

    <a href="mailto:?subject=Teaching%20refactoring%20to%20improve%20code&amp;body=Check out this site %2frefactoring%2f" data-proofer-ignore=""><i class="fa fa-envelope"></i></a>
  </span>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
      
  
    <nav><ul class="pager">
    
        <li class="previous">
          <a href="/teaching_programming_tips/" title="Five quick tips for coding in the classroom">
            <span aria-hidden="true">&larr;</span>Previous
          </a>
        </li>
    

    
      <li class="next">
        <a href="/user/" title="useR!">
            Next <span aria-hidden="true">&rarr;</span>
        </a>
      </li>
    
    </ul> </nav>
  


</div>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
  
<div id="disqus_thread"></div>
<script type="text/javascript">
  (function() {
    
    
    if (window.location.hostname == "localhost")
      return;

    var dsq = document.createElement('script'); dsq.async = true; dsq.type = 'text/javascript';
    dsq.src = '//teachdatascience-com.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>

</footer>

    </div>
    
      <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
        <div>
  

    <div class="section">
      <header><div class="title"><b>Latest Posts</b></div></header>
      <div class="content">
        <ul>
        
          <li>
          <a href="/philosophy/">Philosophical Ethics for Data Science</a>
          </li>
        
          <li>
          <a href="/oath/">Hippocratic Oath</a>
          </li>
        
          <li>
          <a href="/datafem/">Data Feminism</a>
          </li>
        
          <li>
          <a href="/bookclub/">Bookclub on Data Science Ethics</a>
          </li>
        
          <li>
          <a href="/privacy/">Data Privacy</a>
          </li>
        
          <li>
          <a href="/ethicaldataviz/">Ethical Data Viz</a>
          </li>
        
          <li>
          <a href="/reintro/">Re-Introduction: Ethics in Data Science Education</a>
          </li>
        
          <li>
          <a href="/keepbusy/">Keeping Busy with Data Science</a>
          </li>
        
          <li>
          <a href="/nextsteps/">Next Steps</a>
          </li>
        
          <li>
          <a href="/closing/">Closing: A summer of data science education</a>
          </li>
        
        </ul>
      </div>
    </div>

    
      
      
      <div class="section taxonomies">
        <header><div class="title"><b>tag</b></div></header>

        <div class="content">
          <ul>
            <li><a href="/tags/education">education</a></li><li><a href="/tags/r-markdown">r-markdown</a></li><li><a href="/tags/workflow">workflow</a></li><li><a href="/tags/visualization">visualization</a></li><li><a href="/tags/communication">communication</a></li><li><a href="/tags/collaboration">collaboration</a></li><li><a href="/tags/statistics">statistics</a></li><li><a href="/tags/rstudio">rstudio</a></li><li><a href="/tags/data-wrangling">data-wrangling</a></li><li><a href="/tags/ethics">ethics</a></li>
          </ul>
        </div>
      </div>
      
    
      
      
    

</div>

      </div>
    
  </div>
</div>
    
<footer class="footer hidden-print">
  <div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
           <div class="pull-left">
  <a class="toplink" href="javascript:" id="return-to-top">back to top</a>
</div>
<div class="pull-right">

</div>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
              
    
<div class="container footline">
    <small>
  Made with <a href="https://gohugo.io/">Hugo</a>. Themed by <a href="https://github.com/appernetic/hugo-bootstrap-premium">Bootstrap</a>. Deployed to <a href="https://www.netlify.com/">Netlify</a>. Designed and written in California and Massachusetts.

</small>
</div>


    
<div class="container copyright">
    <small>
  &copy; 2019 Copyright Teach Data Science

  </small>
</div>



        </div>
    </div>
  </div>
</footer>

    











<script>
  var _gaq=[['_setAccount','Your Google Analytics tracking code'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

<script>
var ENABLE_POPOVER =  false , 
EXPIRE_COOKIE =  5 , 
SHOW_MODAL_TIMEOUT =  10000 , 
MOUSE_LEAVE =  true , 
MODAL_SIZE = "", 
POST_URL = "https://zapier.com/hooks/catch/1227563/", 
SIGNUP_HEADER = "Join Our Newsletter",
HEADER_IMAGE = "teachdslogosnip2.png",
IMG_DESCRIPTION = "Placeholder image for this popover modal optin form",
SIGNUP_TEXT = "Signup today for free and be the first to get notified on new updates.",
INPUT_PLACEHOLDER = "Enter your email",
SUBMIT_BUTTON = "Subscribe",
SUCCESS_MESSAGE = "Thanks for your subscription!",
ERROR_MESSAGE = "Submitting form failed!",
OPTIN =  true ,
COOKIE_NAME = "mycookie1",
CONTENTLANGUAGE =  null ; 
</script>







<script  src="/js/bundle.min.a0761bf8598edda2bb2c0e348a3160c418f2bc30908f40740ee7f30dabbdeed27d82ee58e16400badd1ae84ce7be7ce10702c9be216abe5de1cb497de995e850.js" ></script>



<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/config/TeX-AMS-MML_HTMLorMML.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    for(var all in MathJax.Hub.getAllJax()) {
        all.SourceElement().parentNode.className += ' has-jax';

    }
});
</script>





  </body>
</html>

