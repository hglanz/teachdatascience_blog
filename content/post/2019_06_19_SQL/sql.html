---
title: "SQL 101 in R"
author: "Nicholas Horton"
date: '2018-06-17T21:13:14-05:00'
output:
  html_document:
    df_print: paged
tags:
- R Markdown
- database
- visualization
- data technologies
- data wrangling
- SQL
categories: R
---



<p>The NASEM Data Science for Undergraduates <a href="https://teachdatascience.com/nasem">report</a> noted that the storage, preparation, and accessing of data is at the heart of data science and that students need to directly experience multiple forms of data, including the use of databases.</p>
<p>SQL (pronounced <em>sequel</em>) stands for <a href="https://en.wikipedia.org/wiki/SQL">Structured Query Language</a>; it is a language designed to manage data in a relational database system. The papers <a href="https://chance.amstat.org/2015/04/setting-the-stage" class="uri">https://chance.amstat.org/2015/04/setting-the-stage</a> and <a href="https://chance.amstat.org/2015/04/databases/" class="uri">https://chance.amstat.org/2015/04/databases/</a> provide a high level overview of database systems.</p>
<p>We will use a public facing MySQL <a href="http://www.science.smith.edu/wai-database/home/about">database</a> containing wideband acoustic immittance (WAI) measures made on normal ears of adults. (The project is funded by the National Institutes of Health, NIDCD, and hosted on a server at Smith College, <a href="https://projectreporter.nih.gov/project_info_description.cfm?aid=8769352&amp;icde=44962011&amp;ddparam=&amp;ddvalue=&amp;ddsub=&amp;cr=46&amp;csb=default&amp;cs=ASC&amp;pball=">PI Susan Voss, R15 DC014129-01</a>.) The database was created to enable auditory researchers to share WAI measurements and combine analyses over multiple datasets.</p>
<p>We begin by demonstrating how SQL queries can be sent to a database. We begin by setting up a connection using the <code>dbConnect()</code> function.</p>
<pre class="r"><code>library(mosaic)
library(RMySQL) # that there are plans to move this support to RMariaDB 
con &lt;- dbConnect(
  MySQL(), host = &quot;scidb.smith.edu&quot;, user = &quot;waiuser&quot;, 
  password = &quot;smith_waiDB&quot;, dbname = &quot;wai&quot;)</code></pre>
<p>Next a series of SQL queries can be sent to the database using the <code>DBI::dbGetQuery()</code> function: each query returns an R dataframe.</p>
<pre class="r"><code>class(dbGetQuery(con, &quot;SHOW TABLES&quot;))
## [1] &quot;data.frame&quot;</code></pre>
<p>There are multiple tables within the <code>wai</code> database.</p>
<pre class="r"><code>dbGetQuery(con, &quot;SHOW TABLES&quot;)
##       Tables_in_wai
## 1      Measurements
## 2 Measurements_2020
## 3           PI_Info
## 4       PI_Info_OLD
## 5           Subject
## 6     Subjects_2020</code></pre>
<p>The <code>EXPLAIN</code> command describes the ten field names (variables) in the <code>PI_Info</code> table.</p>
<pre class="r"><code>dbGetQuery(con, &quot;EXPLAIN PI_Info&quot;)
##                 Field        Type Null Key Default Extra
## 1          Identifier varchar(50)   NO PRI    &lt;NA&gt;      
## 2                Year     int(11)   NO        &lt;NA&gt;      
## 3             Authors        text   NO        &lt;NA&gt;      
## 4    AuthorsShortList        text   NO        &lt;NA&gt;      
## 5               Title        text   NO        &lt;NA&gt;      
## 6             Journal        text   NO        &lt;NA&gt;      
## 7                 URL        text   NO        &lt;NA&gt;      
## 8            Abstract        text   NO        &lt;NA&gt;      
## 9   DataSubmitterName        text   NO        &lt;NA&gt;      
## 10 DataSubmitterEmail        text   NO        &lt;NA&gt;      
## 11      DateSubmitted        text   NO        &lt;NA&gt;      
## 12           PI_Notes        text   NO        &lt;NA&gt;</code></pre>
<p>The <code>SELECT</code> statement can be used to select all fields for eight observations in the <code>Measurements</code> table.</p>
<pre class="r"><code>eightobs &lt;- dbGetQuery(con, &quot;SELECT * FROM Measurements LIMIT 8&quot;)
eightobs
##   Identifier Sub_Number Session Left_Ear MEP Instrument    Freq Absorbance
## 1  Abur_2014          1       1        0  -5          1 210.938  0.0451375
## 2  Abur_2014          1       1        0  -5          1 234.375  0.0441247
## 3  Abur_2014          1       1        0  -5          1 257.812  0.0495935
## 4  Abur_2014          1       1        0  -5          1 281.250  0.0516088
## 5  Abur_2014          1       1        0  -5          1 304.688  0.0590836
## 6  Abur_2014          1       1        0  -5          1 328.125  0.0628038
## 7  Abur_2014          1       1        0  -5          1 351.562  0.0682962
## 8  Abur_2014          1       1        0  -5          1 375.000  0.0738373
##        Zmag      Zang Canal_Area
## 1 110638000 -0.228113         NA
## 2 100482000 -0.230561         NA
## 3  90561100 -0.230213         NA
## 4  83515500 -0.230959         NA
## 5  77476800 -0.229652         NA
## 6  71229100 -0.230026         NA
## 7  66615500 -0.229576         NA
## 8  61996200 -0.229327         NA</code></pre>
<p>More interesting and complicated <code>SELECT</code> calls can be used to undertake grouping and aggregation. Here we calculate the sample size for each study</p>
<pre class="r"><code>dbGetQuery(con, 
  &quot;SELECT Identifier, count(*) AS NUM FROM Measurements GROUP BY Identifier ORDER BY NUM&quot;)
##       Identifier    NUM
## 1       Sun_2016   2604
## 2    Shaver_2013   2880
## 3    Feeney_2017   3162
## 4      Voss_1994   5120
## 5       Liu_2008   5520
## 6    Werner_2010   7935
## 7  Rosowski_2012  14384
## 8      Voss_2010  14880
## 9      Abur_2014  21328
## 10    Groon_2015  35469
## 11  Shahnaz_2006  58776
## 12    Lewis_2015 114716</code></pre>
<div id="accessing-a-database-using-dplyr-commands" class="section level2">
<h2>Accessing a database using dplyr commands</h2>
<p>Alternatively, a connection can be made to the server by creating a series of <code>dplyr</code> tbl
objects. Connecting with familiar <code>dplyr</code> syntax is attractive because, as <a href="https://dbplyr.tidyverse.org/articles/dbplyr.html">Hadley Wickham</a> has noted, SQL and R have similar syntax (but sufficiently different to be confusing).</p>
<p>The setup process looks similar.</p>
<pre class="r"><code>Measurements &lt;- tbl(con, &quot;Measurements&quot;)
class(Measurements)
## [1] &quot;tbl_MySQLConnection&quot; &quot;tbl_dbi&quot;             &quot;tbl_sql&quot;            
## [4] &quot;tbl_lazy&quot;            &quot;tbl&quot;
PI_Info &lt;- tbl(con, &quot;PI_Info&quot;)
Subject &lt;- tbl(con, &quot;Subject&quot;)</code></pre>
<p>We explore the <code>PI_Info</code> table using the <code>collect()</code> function used to force computation on the database (and return the results). One attractive aspect of database systems is that they feature <a href="https://en.wikipedia.org/wiki/Lazy_evaluation"><em>lazy evaluation</em></a>, where computation is optimized and postponed as long as possible.</p>
<pre class="r"><code>PI_Info  %&gt;% summarise(total = n())
## # Source:   lazy query [?? x 1]
## # Database: mysql 5.5.58-0ubuntu0.14.04.1-log [waiuser@scidb.smith.edu:/wai]
##   total
##   &lt;dbl&gt;
## 1    12
PI_Info %&gt;% collect() %&gt;% data.frame()   
##       Identifier Year
## 1      Abur_2014 2014
## 2    Feeney_2017 2017
## 3     Groon_2015 2015
## 4     Lewis_2015 2015
## 5       Liu_2008 2008
## 6  Rosowski_2012 2012
## 7   Shahnaz_2006 2006
## 8    Shaver_2013 2013
## 9       Sun_2016 2016
## 10     Voss_1994 1994
## 11     Voss_2010 2010
## 12   Werner_2010 2010
##                                                                                                                                          Authors
## 1                                                                                              Defne Abur, Nicholas J. Horton, and Susan E. Voss
## 2   M. Patrick Feeney,  Douglas H. Keefe, Lisa L. Hunter,  Denis F. Fitzpatrick, Angela C. Garinis, Daniel B. Putterman, and Garnett P. McMillan
## 3                                               Katherine A. Groon, Daniel M. Rasetshwane, Judy G. Kopun, Michael P. Gorga, and Stephen T. Neely
## 4                                                                                                            James D. Lewis and Stephen T. Neely
## 5                                  Yi-Wen Liu, Chris A. Sanford,  John C. Ellison, Denis F. Fitzpatrick,  Michael P. Gorga, and Douglas H. Keefe
## 6  John J. Rosowski, Hideko H. Nakajima, Mohamad A. Hamade, Lorice Mahfoud, Gabrielle R. Merchant, Christopher F. Halpin, and Saumil N. Merchant
## 7                                                                                                                   Navid Shahnaz and Karin Bork
## 8                                                                                                               Mark D. Shaver and Xiao-Ming Sun
## 9                                                                                                                                  Xiao-Ming Sun
## 10                                                                                                               Susan E. Voss and Jont B. Allen
## 11                               Susan E. Voss, Modupe F. Adegoke, Nicholas J. Horton, Kevin N. Sheth, Jonathan Rosand, and Christopher A. Shera
## 12                                                                                          Lynne A. Werner, Ellen C. Levi, and Douglas H. Keefe
##    AuthorsShortList
## 1       Abur et al.
## 2     Feeney et al.
## 3      Groon et al.
## 4   Lewis and Neely
## 5        Liu et al.
## 6   Rosowski et al.
## 7  Shahnaz and Bork
## 8    Shaver and Sun
## 9               Sun
## 10   Voss and Allen
## 11      Voss et al.
## 12    Werner et al.
##                                                                                                                                     Title
## 1                                                                                          Instrasubject Variability in Power Reflectance
## 2       Normative wideband reflectance, equivalent admittance at the tympanic membrane, and acoustic stapedius reflex threshold in adults
## 3                                                                                       Air-Leak Effects on Ear-Canal Acoustic Absorbance
## 4                                                                    Non-invasive estimation of middle-ear input impedance and efficiency
## 5                    Wideband absorbance tympanometry using pressure sweeps: System development and results on adults with normal hearing
## 6                                                         Ear-canal reflectance, umbo velocity, and tympanometry in normal-hearing adults
## 7                                                                       Wideband reflectance norms for caucasian and chinese young adults
## 8  Wideband energy reflectance measurements: Effects of negative middle ear pressure and application of a pressure compensation procedure
## 9                       Wideband acoustic immittance: Normative study and test-retest reliability of tympanometric measurements in adults
## 10                                                               Measurement of acoustic impedance and reflectance in the human ear canal
## 11                                                               Posture systematically alters ear-canal reflectance and DPOAE properties
## 12                                            Ear-canal wideband acoustic transfer functions of adults and two- to nine-month-old infants
##                   Journal
## 1        J Am Acad Audiol
## 2                Ear Hear
## 3                Ear Hear
## 4         J Acoust Soc Am
## 5         J Acoust Soc Am
## 6                Ear Hear
## 7                Ear Hear
## 8         J Acoust Soc Am
## 9  J Speech Lang Hear Res
## 10        J Acoust Soc Am
## 11               Hear Res
## 12               Ear Hear
##                                                                                                                   URL
## 1                                                                        https://www.ncbi.nlm.nih.gov/pubmed/25257718
## 2                                                                        https://www.ncbi.nlm.nih.gov/pubmed/28045835
## 3  https://journals.lww.com/ear-hearing/fulltext/2015/01000/Air_Leak_Effects_on_Ear_Canal_Acoustic_Absorbance.16.aspx
## 4                                                                 https://asa.scitation.org/doi/abs/10.1121/1.4927408
## 5                                                                        https://www.ncbi.nlm.nih.gov/pubmed/19206798
## 6                                                                         http://www.ncbi.nlm.nih.gov/pubmed/21857517
## 7        http://journals.lww.com/ear-hearing/Abstract/2006/12000/Wideband_Reflectance_Norms_for_Caucasian_and.15.aspx
## 8                                                            &quot;\nhttps://asa.scitation.org/doi/full/10.1121/1.4807509&quot;
## 9                                                                        https://www.ncbi.nlm.nih.gov/pubmed/27517667
## 10                                                                 https://asa.scitation.org/doi/abs/10.1121/1.408329
## 11                                                                       https://www.ncbi.nlm.nih.gov/pubmed/20227475
## 12                                                                       https://www.ncbi.nlm.nih.gov/pubmed/20517155
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Abstract
## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          &quot;Background: Power reflectance measurements are an active area of research related to the development of noninvasive middle-ear assessment methods. There are limited data related to test-retest measures of power reflectance.\n\nPurpose: This study investigates test-retest features of power reflectance, including comparisons of intrasubject versus intersubject variability and how ear-canal measurement location affects measurements.\n\nResearch design: Repeated measurements of power reflectance were made at about weekly intervals. The subjects returned for four to eight sessions. Measurements were made at three ear-canal locations: a deep insertion depth (with a foam plug flush at the entrance to the ear canal) and both 3 and 6 mm more lateral to this deep insertion.\n\nStudy sample: Repeated measurements on seven subjects are reported. All subjects were female, between 19 and 22 yr old, and enrolled at an undergraduate women&#39;s college.\n\nData collection and analysis: Measurements on both the right and left ears were made at three ear-canal locations during each of four to eight measurement sessions. Random-effects regression models were used for the analysis to account for repeated measures within subjects. The mean power reflectance for each position over all sessions was calculated for each subject.\n\nResults: The comparison of power reflectance from the left and right ears of an individual subject varied greatly over the seven subjects; the difference between the power reflectance measured on the left and that measured on the right was compared at 248 frequencies, and depending on the subject, the percentage of tested frequencies for which the left and right ears differed significantly ranged from 10% to 93% (some with left values greater than right values and others with the opposite pattern). Although the individual subjects showed left-right differences, the overall population generally did not show significant differences between the left and right ears. The mean power reflectance for each measurement position over all sessions depended on the location of the probe in the ear for frequencies of less than 1000 Hz. The standard deviation between subjects&#39; mean power reflectance after controlling for ear (left or right) was found to be greater than the standard deviation within the individual subject&#39;s mean power reflectance. The intrasubject standard deviation in power reflectance was smallest at the deepest insertion depths.\n\nConclusions: All subjects had differences in power reflectance between their left and right ears at some frequencies; the percentage of frequencies at which differences occurred varied greatly across subjects. The intrasubject standard deviations were smallest for the deepest probe insertion depths, suggesting clinical measurements should be made with as deep an insertion as practically possible to minimize variability. This deep insertion will reduce both acoustic leaks and the effect of low-frequency ear-canal losses. The within-subject standard deviations were about half the magnitude of the overall standard deviations, quantifying the extent of intrasubject versus intersubject variability.&quot;
## 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           &quot;Objectives: Wideband acoustic immittance (WAI) measures such as pressure reflectance, parameterized by absorbance and group delay, equivalent admittance at the tympanic membrane (TM), and acoustic stapedius reflex threshold (ASRT) describe middle ear function across a wide frequency range, compared with traditional tests employing a single frequency. The objective of this study was to obtain normative data using these tests for a group of normal-hearing adults and investigate test–retest reliability using a longitudinal design.\n\nDesign: A longitudinal prospective design was used to obtain normative test and retest data on clinical and WAI measures. Subjects were 13 males and 20 females (mean age = 26 years). Inclusion criteria included normal audiometry and clinical immittance. Subjects were tested on two separate visits approximately 1 month apart. Reflectance and equivalent admittance at the TM were measured from 0.25 to 8.0 kHz under three conditions: at ambient pressure in the ear canal and with pressure sweeps from positive to negative pressure (downswept) and negative to positive pressure (upswept). Equivalent admittance at the TM was calculated using admittance measurements at the probe tip that were adjusted using a model of sound transmission in the ear canal and acoustic estimates of ear-canal area and length. Wideband ASRTs were measured at tympanometric peak pressure (TPP) derived from the average TPP of downswept and upswept tympanograms. Descriptive statistics were obtained for all WAI responses, and wideband and clinical ASRTs were compared.\n\nResults: Mean absorbance at ambient pressure and TPP demonstrated a broad band-pass pattern typical of previous studies. Test-retest differences were lower for absorbance at TPP for the downswept method compared with ambient pressure at frequencies between 1.0 and 1.26 kHz. Mean tympanometric peak-to-tail differences for absorbance were greatest around 1.0 to 2.0 kHz and similar for positive and negative tails. Mean group delay at ambient pressure and at TPP were greatest between 0.32 and 0.6 kHz at 200 to 300 ?sec, reduced at frequencies between 0.8 and 1.5 kHz, and increased above 1.5 kHz to around 150 ?sec. Mean equivalent admittance at the TM had a lower level for the ambient method than at TPP for both sweep directions below 1.2 kHz, but the difference between methods was only statistically significant for the comparison between the ambient method and TPP for the upswept tympanogram. Mean equivalent admittance phase was positive at all frequencies. Test–retest reliability of the equivalent admittance level ranged from 1 to 3 dB at frequencies below 1.0 kHz, but increased to 8 to 9 dB at higher frequencies. The mean wideband ASRT for an ipsilateral broadband noise activator was 12 dB lower than the clinical ASRT, but had poorer reliability.\n\nConclusions: Normative data for the WAI test battery revealed minor differences for results at ambient pressure compared with tympanometric methods at TPP for reflectance, group delay, and equivalent admittance level at the TM for subjects with middle ear pressure within ±100 daPa. Test–retest reliability was better for absorbance at TPP for the downswept tympanogram compared with ambient pressure at frequencies around 1.0 kHz. Large peak-to-tail differences in absorbance combined with good reliability at frequencies between about 0.7 and 3.0 kHz suggest that this may be a sensitive frequency range for interpreting absorbance at TPP. The mean wideband ipsilateral ASRT was lower than the clinical ASRT, consistent with previous studies. Results are promising for the use of a wideband test battery to evaluate middle ear function.\n\nKey words: Absorbed sound power, Acoustic stapedius reflex threshold, Reflectance, Test–retest reliability, Wideband acoustic immittance.&quot;
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         &quot;Objective: Accurate ear-canal acoustic measurements, such as wideband acoustic admittance, absorbance, and otoacoustic emissions, require that the measurement probe be tightly sealed in the ear canal. Air leaks can compromise the validity of the measurements, interfere with calibrations, and increase variability. There are no established procedures for determining the presence of air leaks or criteria for what size leak would affect the accuracy of ear-canal acoustic measurements. The purpose of this study was to determine ways to quantify the effects of air leaks and to develop objective criteria to detect their presence.\n\nDesign: Air leaks were simulated by modifying the foam tips that are used with the measurement probe through insertion of thin plastic tubing. To analyze the effect of air leaks, acoustic measurements were taken with both modified and unmodified foam tips in brass-tube cavities and human ear canals. Measurements were initially made in cavities to determine the range of critical leaks. Subsequently, data were collected in ears of 21 adults with normal hearing and normal middle-ear function. Four acoustic metrics were used for predicting the presence of air leaks and for quantifying these leaks: (1) low-frequency admittance phase (averaged over 0.1–0.2 kHz), (2) low-frequency absorbance, (3) the ratio of compliance volume to physical volume (CV/PV), and (4) the air-leak resonance frequency. The outcome variable in this analysis was the absorbance change (?absorbance), which was calculated in eight frequency bands.\n\nResults: The trends were similar for both the brass cavities and the ear canals. ?Absorbance generally increased with air-leak size and was largest for the lower frequency bands (0.1–0.2 and 0.2–0.5 kHz). Air-leak effects were observed in frequencies up to 10 kHz, but their effects above 1 kHz were unpredictable. These high-frequency air leaks were larger in brass cavities than in ear canals. Each of the four predictor variables exhibited consistent dependence on air-leak size. Low-frequency admittance phase and CV/PV decreased, while low-frequency absorbance and the air-leak resonance frequency increased.\n\nConclusion: The effect of air leaks can be significant when their equivalent diameter exceeds 0.01 in. The observed effects were greatest at low frequencies where air leaks caused absorbance to increase. Recommended criteria for detecting air leaks include the following: when the frequency range of interest extends as low as 0.1 kHz, low-frequency absorbance should be ?0.20 and low-frequency admittance phase ?61 degrees. For frequency ranges as low as 0.2 kHz, low-frequency absorbance should be ?0.29 and low-frequency admittance phase ?44 degrees.&quot;
## 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   A method to transform the impedance measured in the ear canal, ZEC, to the plane of the eardrum, ZED, is described. The portion of the canal between the probe and eardrum was modeled as a concatenated series of conical segments, allowing for spatial variations in its cross-sectional area. A model of the middle ear (ME) and cochlea terminated the ear-canal model, which permitted estimation of ME efficiency. Acoustic measurements of ZEC were made at two probe locations in 15 normal-hearing subjects. ZEC was sensitive to measurement location, especially near frequencies of canal resonances and anti-resonances. Transforming ZEC to ZED reduced the influence of the canal, decreasing insertion-depth sensitivity of ZED between 1 and 12 kHz compared to ZEC. Absorbance, A, was less sensitive to probe placement than ZEC, but more sensitive than ZED above 5 kHz. ZED and A were similarly insensitive to probe placement between 1 and 5 kHz. The probe-placement sensitivity of ZED below 1 kHz was not reduced from that of either A or ZEC. ME efficiency had a bandpass shape with greatest efficiency between 1 and 4 kHz. Estimates of ZED and ME efficiency could extend the diagnostic capability of wideband-acoustic immittance measurements.
## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          A system with potential for middle-ear screening and diagnostic testing was developed for the measurement of wideband energy absorbance (EA) in the ear canal as a function of air pressure, and tested on adults with normal hearing. Using a click stimulus, the EA was measured at 60 frequencies between 0.226 and 8 kHz. Ambient-pressure results were similar to past studies. To perform tympanometry, air pressure in the ear canal was controlled automatically to sweep between ?300 and 200 daPa (ascending/descending directions) using sweep speeds of approximately 75, 100, 200, and 400 daPa/ s. Thus, the measurement time for wideband tympanometry ranged from 1.5 to 7 s and was suitable for clinical applications. A bandpass tympanogram, calculated for each ear by frequency averaging EA from 0.38 to 2 kHz, had a single-peak shape; however, its tympanometric peak pressure (TPP) shifted as a function of sweep speed and direction. EA estimated at the TPP was similar across different sweep speeds, but was higher below 2 kHz than EA measured at ambient pressure. Future studies of EA on normal ears of a different age group or on impaired ears may be compared with the adult normal baseline obtained in this study.
## 6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     &quot;Objective: This study compares measurements of ear-canal reflectance (ECR) to other objective measurements of middle ear function including audiometry, umbo velocity (VU), and tympanometry in a population of strictly defined normal-hearing ears.\n\nDesign: Data were prospectively gathered from 58 ears of 29 normalhearing subjects, 16 females and 13 males, aged 22 to 64 yr. Subjects met all of the following criteria to be considered as having normal hearing: (1) no history of significant middle ear disease; (2) no history of otologic surgery; (3) normal tympanic membrane on otoscopy; (4) pure-tone audiometric thresholds of 20 dB HL or better for 0.25 to 8 kHz; (5) air-bone gaps no greater than 15 dB at 0.25 kHz and 10 dB for 0.5 to 4 kHz; (6) normal, type-A peaked tympanograms; and (7) all subjects had two &quot;&quot;normal&quot;&quot; ears (as defined by these criteria). Measurements included pure-tone audiometry for 0.25 to 8 kHz, standard 226 Hz tympanometry, ECR for 0.2 to 6 kHz at 60 dB SPL using the Mimosa Acoustics HearID system, and umbo velocity (VU) for 0.3 to 6 kHz at 70 to 90 dB SPL using the HLV-1000 laser Doppler vibrometer (Polytec Inc).\n\nResults: Mean power reflectance (|ECR|2) was near 1.0 at 0.2 to 0.3 kHz, decreased to a broad minimum of 0.3 to 0.4 between 1 and 4 kHz, and then sharply increased to almost 0.8 by 6 kHz. The mean pressure reflectance phase angle (?ECR) plotted on a linear frequency scale showed a group delay of approximately 0.1 msec for 0.2 to 6 kHz. Small significant differences were observed in |ECR|2 at the lowest frequencies between right and left ears and between males and females at 4 kHz. |ECR|2 decreased with age but reached significance only at 1 kHz. Our ECR measurements were generally similar to previous published reports. Highly significant negative correlations were found between |ECR|2 and VU for frequencies below 1 kHz. Significant correlations were also found between the tympanometrically determined peak total compliance and |ECR|2 and VU at frequencies below 1 kHz. The results suggest that middle ear compliance contributes significantly to the measured power reflectance and umbo velocity at frequencies below 1 kHz but not at higher frequencies.\n\nConclusions: This study has established a database of objective measurements of middle ear function (ECR, umbo velocity, tympanometry) in a population of strictly defined normal-hearing ears. These data will promote our understanding of normal middle ear function and will serve as a control for comparison to similar measurements made in pathological ears.&quot;
## 7  &quot;Objective: This study examined differences between the middle ears of two ethnic groups, Caucasian and Chinese young adults with normal hearing, using a new middle-ear measurement technique, wideband energy reflectance. The goal of this study was to determine whether the Chinese group had different middle-ear transmission properties than the Caucasian group.\n\nDesign: There were 126 subjects (237 ears) between the ages of 18 and 32 yr, with 62 subjects in the Caucasian group and 64 subjects in the Chinese group. Wideband energy reflectance data were gathered using Mimosa Acoustics (RMS system version 4.0.4.4) wideband reflectance (WBR) equipment.\n\nResults: The Chinese group had significantly lower wideband energy reflectance than their Caucasian counterparts at higher frequencies; however, the Caucasian group had significantly lower energy reflectance at lower frequencies than the Chinese group. The Chinese group also had significantly lower admittance magnitude than the Caucasian group at lower frequencies. Because body size indices are more comparable between Caucasian females and Chinese males, the effect of body size could be potentially adjusted for by comparing the Caucasian female subjects with the Chinese male subjects. The differences observed between the Caucasian and the Chinese groups were no longer significant when the Caucasian female subjects were compared with the Chinese male subjects. Applying the Caucasian norms to four Caucasian adults with surgically confirmed otosclerosis resulted in an improved hit rate compared with the combined Caucasian and Chinese norms and the Chinese-only norms.\n\nConclusions: Body size may play a role in the observed differences between the Caucasian and Chinese groups. The findings of this study suggest that further research is needed to investigate the effects of body size on wideband energy reflectance. It should be noted that factors other than body size may contribute to the observed differences. Chinese individuals may simply have different middle-ear characteristics than Caucasian individuals, which could affect WBR. In the meantime, overall test performance may be improved by using a more homogeneous norm when evaluating the middle ear of Caucasian or Chinese individuals with WBR.\n\n(Ear &amp; Hearing 2006;27;774-788)\n\nObjective: This study examined differences between a group of normal-hearing Caucasian and Chinese young adults on six tympanometric parameters. The goal of this study was to determine if the Chinese group had different low and multifrequency tympanometry results than the Caucasian group.\n\nDesign: There were a total of 159 subjects (303 ears) between the ages of 18 and 34 years, with 76 subjects in the Caucasian group and 83 subjects in the Chinese group. Tympanometric data were gathered on a clinical immittance machine, the Virtual 310 equipped with a high frequency option. Four of the parameters - static admittance (SA), tympanometric width (TW), tympanometric peak pressure (TPP), and ear-canal volume (ECV) - were measured automatically at a standard 226 Hz frequency. The remaining two parameters - resonant frequency (RF) and SA up to 1200 Hz - were measured by multifrequency, multicomponent tympanometry, using a mathematical approach.\n\nResults: The Chinese group had significantly lower SA, wider TW, more positive TPP, and lower ECV than their Caucasian counterparts. The parameter of SA up to 1200 Hz showed a significant group effect (Caucasian versus Chinese) until 900 Hz in the male group and up to 1120 Hz in the female group. The Chinese group had significantly higher RF than the Caucasian group. Once the effect of body size was compensated by adjusting for the ear canal and the middle ear volumes, the differences observed between the Caucasian and the Chinese groups were no longer significant for tympanometric parameters obtained at standard probe tone frequency of 226 Hz; however, the effect was still significant for SA obtained at higher probe tone frequencies (560, 630, 710, 800, and 900 Hz) and for RF. Applying the Caucasian norms to a group of mainly Caucasian adults with surgically confirmed otosclerosis resulted in improved overall test performance when compared with the combined Caucasian and Chinese norms and the Chinese only norms.\n\nConclusions: It seems that the body size plays a crucial factor in the observed differences between the Caucasian group and Chinese groups at a standard probe tone frequency of 226 Hz; however, other mechano-acoustical properties of the middle ear may contribute to these differences at higher probe tone frequencies. Findings of this study suggest that further research is needed to investigate the effects of body size on immittance measures with other ethnic groups. In the meantime, overall test performance may be improved by using a more homogenous norm when testing the Caucasian or Chinese individuals.&quot;
## 8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               The wideband energy reflectance (ER) technique has become popular as a tool for evaluating middle ear function. Negative middle ear pressure (MEP) is a prevalent form of middle ear dysfunction, which may impact application of ER measurements in differential diagnosis. A negative MEP may be countervailed by application of an equivalent negative ear canal pressure. The present study examined ER in the same ears under normal and experimentally induced negative MEP conditions. Thirty-five subjects produced at least one negative MEP each (?40 to ?225 daPa). Negative MEP significantly altered ER in a frequency-specific manner that varied with MEP magnitude. ER increased for low- to mid-frequencies with the largest change (~0.20 to 0.40) occurring between 1 and 1.5 kHz. ER decreased for frequencies above 3 kHz with the largest change (~?0.10 to ?0.25) observed between 4.5 and 5.5 kHz. Magnitude of changes increased as MEP became more negative, as did the frequencies at which maximum changes occurred, and the frequency at which enhancement transitioned to reduction. Ear canal pressure compensation restored ER to near baseline values. This suggests that the compensation procedure adequately mitigates the effects of negative MEP on ER. Theoretical issues and clinical implications are discussed.
## 9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       &quot;Purpose: The purpose of this study was to present normative data of tympanometric measurements of wideband acoustic immittance and to characterize wideband tympanograms.\n\nMethod: Data were collected in 84 young adults with strictly defined normal hearing and middle ear status. Energy absorbance (EA) was measured using clicks for 1/12?octave frequencies (0.236 to 8 kHz), with the ear canal air pressure systematically varied (+200 to ?300 daPa). In 40 ears, 7 consecutive trials and a trial of clinical 226-Hz acoustic admittance (Ya) tympanometry followed. A cavity test was also conducted.\n\nResults: From the wideband EA tympanogram, several EA spectrums and EA tympanograms were derived. Descriptive statistics were performed, and population parameters were estimated. The immediate test?retest reliability was excellent. Effects of ear canal air pressure on EA were examined comprehensively. Differences in EA between tympanometric and ambient-pressure measurements were significant. Single-frequency EA tympanograms exemplified for half-octave frequencies were contrasted. The bandpass EA tympanogram, 0.236? and 1?kHz EA and Ya tympanograms, and 226-Hz Ya tympanogram were compared in 9 variables.\n\nConclusions: This study established a database of wideband tympanograms in healthy adults. The data analyses will promote our understanding of the middle ear transfer function. These data will serve as a reference for further studies in clinical populations.&quot;
## 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       The pressure reflectance R (?) is the transfer function which may be defined for a linear one-port network by the ratio of the reflected complex pressure divided by the incident complex pressure. The reflectance is a function that is closely related to the impedance of the 1-port. The energy reflectance ?(?) is defined as |R|2. It represents the ratio of reflected to incident energy. In the human ear canal the energy reflectance is important because it is a measure of the inefficiency of the middle ear and cochlea, and because of the insight provided by its simple frequency domain interpretation. One may characterize the ear canal impedance by use of the pressure reflectance and its magnitude, sidestepping the difficult problems of (a) the unknown canal length from the measurement point to the eardrum, (b) the complicated geometry of the drum, and (c) the cross-sectional area changes in the canal as a function of distance. Reported here are acoustic impedancem easurements looking into the ear canal, measured on ten young adults with normal hearing (ages 18-24). The measurement point in the canal was approximately 0.85 cm from the entrance of the canal. From these measurements, the pressure reflectance in the canal is computed and impedance and reflectance measurements from 0.1 to 15.0 kHz are compared among ears. The average reflectance and the standard deviation of the reflectance for the ten subjects have been determined. The impedance and reflectance of two common ear simulators, the Brüel &amp; Kjaer 4157 and the Industrial Research Products DB-100 (Zwislocki) coupler are also measured and compared to the average human measurements. All measurements are made using controls that assure a uniform accuracy in the acoustic calibration across subjects. This is done by the use of two standard acoustic resistors whose impedances are known. From the experimental results, it is concluded that there is significant subject variability in the magnitude of the reflectance for the ten ear canals. This variability is believed to be due to cochlear and middle ear impedance differences. An attempt was made at modeling the reflectance but, as discussed in the paper, several problems presently stand in the way of these models. Such models would be useful for acoustic virtual-reality systems and for active noise control earphones.
## 11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Several studies have demonstrated that the auditory system is sensitive to changes in posture, presumably through changes in intracranial pressure (ICP) that in turn alter the intracochlear pressure, which affects the stiffness of the middle-ear system. This observation has led to efforts to develop an ear-canal based noninvasive diagnostic measure for monitoring ICP, which is currently monitored invasively via access through the skull or spine. Here, we demonstrate the effects of postural changes, and presumably ICP changes, on distortion product otoacoustic emissions (DPOAE) magnitude, DPOAE angle, and power reflectance. Measurements were made on 12 normal-hearing subjects in two postural positions: upright at 90° and tilted at -45° to the horizontal. Measurements on each subject were repeated five times across five separate measurement sessions. All three measures showed significant changes (p &lt; 0.001) between upright and tilted for frequencies between 500 and 2000 Hz, and DPOAE angle changes were significant at all measured frequencies (500-4000 Hz). Intra-subject variability, assessed via standard deviations for each subject&#39;s multiple measurements, were generally smaller in the upright position relative to the tilted position.
## 12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               &quot;Objectives: Wideband acoustic transfer functions (WATF) measured in the ear canal have been shown to be effective in the diagnosis of middle ear dysfunction in adults and in newborn infants. Although these measures would be diagnostically useful in older infants, normative data on a large number of older infants are lacking. The goal of this study was to provide such normative data.\n\nDesign: The WATF of 458 infants aged 2 to 9 mos and of 210 adults were obtained. Wideband reactance (X), resistance (R), and energy reflectance (ER) were measured in third-octave bands between 250 and 8000 Hz. The effects of age and gender on the WATF were examined, and the WATF in the left and right ears were compared. Test-retest reliability was assessed, and the relationship between the 226-Hz tympanogram and the WATF was examined.\n\nResults: The results agreed well with previous reports testing fewer subjects, which documented age-related change in these measures during infancy and between infancy and adulthood. Test-retest correlations within third octaves were 0.5 to 0.7 at best, but did not vary systematically with age. Infants&#39; test-retest absolute differences within third octaves for R and ER were similar to those of adults. The shape of the WATF on retest was highly repeatable, and the shapes of the WATF in the ears of the same individual were qualitatively similar. The wideband impedance results were not different in the left and right ears, but ER was slightly, but significantly, lower in the left ear than that in the right ear. Resistance and reactance magnitude were greater for females than males, but there was no effect of gender on ER. Infants whose 226-Hz tympanogram indicated reduced peak admittance (Types As and B) had greater resistance and reactance magnitude than those with normal peak admittance (Types A and C), but no tympanometry group differences were evident in ER.\n\nConclusions: Age-graded norms are essential to the successful clinical application of WATF. However, the effects of gender and laterality on the WATF are small.&quot;
##                      DataSubmitterName
## 1                           Susan Voss
## 2  M. Patrick Feeney; Douglas H. Keefe
## 3                          Steve Neely
## 4                          James Lewis
## 5                        Douglas Keefe
## 6                        John Rosowski
## 7                        Navid Shahnaz
## 8                        Xiao-Ming Sun
## 9                        Xiao-Ming Sun
## 10                          Susan Voss
## 11                          Susan Voss
## 12                       Douglas Keefe
##                                   DataSubmitterEmail DateSubmitted
## 1                                    svoss@smith.edu       8/24/16
## 2  Patrick.Feeney@va.gov; Douglas.Keefe@boystown.org        6/7/18
## 3                         Stephen.Neely@boystown.org    06/18/2019
## 4                                  jdlewis@uthsc.edu      10/10/18
## 5                         Douglas.Keefe@boystown.org       6/26/18
## 6                     John_Rosowski@meei.harvard.edu       11/6/15
## 7                        nshahnaz@audiospeech.ubc.ca       8/24/16
## 8                          xiao-ming.sun@wichita.edu       10/6/18
## 9                          xiao-ming.sun@wichita.edu      10/31/17
## 10                                   svoss@smith.edu        2/8/17
## 11                                   svoss@smith.edu        6/5/18
## 12                        Douglas.Keefe@boystown.org        9/1/17
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     PI_Notes
## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Database includes measurements at Position 1 and Channel B only.
## 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         Data collected on system described in Rasetshwane and Neely (2011)
## 4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           &quot;Custom system ER10B+ used for measurement of ear canal impedance designed by Dr. J. H. Siegel at Northwestern University.\n\nEar canal areas were estimated from the surge impedance.\n\nImpedance was measured at 2 insertion depths (deep – session 1, shallow – session 2).&quot;
## 5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
## 6  &quot;HearID (Mimosa Acoustics); \nNormal Criteria as follows: \n(1) There was no history of significant middle ear disease (e.g., otitis media or effusion 2 or more years previously were not considered significant if there were no known residual consequences).\n(2) There was no history of otologic surgery, with the exception of myringotomy or tympanostomy tube placement over 2 yr prior. \n(3) The external ear and TM revealed no abnormalities on otoscopic examination. \n(4) Audiometric measurements had pure-tone thresholds of 20 dB HL or better at octave frequen- cies between 0.250 and 8 kHz. \n(5) Air-bone gaps were no greater than 15 dB at 0.25 kHz and 10 dB between frequencies of 0.5 to 4 kHz. Most subjects had air and bone thresholds between 0 and 10 dB HL with an average near 8 to 9 dB HL at the highest frequencies. \n(6) Tympanograms were Type-A peaked, with peak pressures of 100 to 50 daPa, static compliance of 0.3 to 2.0 cc, total tympanometric volumes (static compliance ear canal volume) between 0.7 and 2.7 cc, and normal-appearing shape that is neither rounded nor sharp. \n(7) All subjects included in the “normal hearing” population were required to have two “normal” ears (as defined by criteria described earlier). &quot;
## 7                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
## 8                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     A research version of Titan (Interacoustics) was used. In this study, a total of five reflectance measurements at ambient pressure were taken per ear (detailed in the article). But, results from only two sessions were reported in this article. Included in this database is the second session (baseline), as the normative data.
## 9                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
## 10                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
## 11                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
## 12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 Used an ER-1 earphone and ER-7C microphone.  Data provided by Doug Keefe and formatted by Susan Voss with help.  Lynne Werner is retired.
# be careful with collect() when dealing with large tables!</code></pre>
<p>Note how the number of rows is unknown (<code>??</code> at the top of the output above) for the lazy query.</p>
<p>Similarly, we can explore the <code>Subjects</code> table.</p>
<pre class="r"><code>Subject  %&gt;% summarise(total = n())
## # Source:   lazy query [?? x 1]
## # Database: mysql 5.5.58-0ubuntu0.14.04.1-log [waiuser@scidb.smith.edu:/wai]
##   total
##   &lt;dbl&gt;
## 1   640
Subject %&gt;% collect()  # be careful with collect() with large tables!
## # A tibble: 640 x 10
##    Identifier Sub_Number Session_Total   Age Female  Race Ethnicity
##    &lt;chr&gt;      &lt;chr&gt;              &lt;int&gt; &lt;int&gt;  &lt;int&gt; &lt;int&gt;     &lt;int&gt;
##  1 Voss_2010  1                      5    20      1     0         0
##  2 Voss_2010  2                      5    39      1     0         0
##  3 Voss_2010  3                      5    18      1     0         0
##  4 Voss_2010  4                      5    19      1     0         0
##  5 Voss_2010  5                      5    21      1     0         0
##  6 Voss_2010  6                      5    21      1     0         0
##  7 Voss_2010  7                      5    21      1     0         0
##  8 Voss_2010  8                      5    42      1     0         0
##  9 Voss_2010  9                      5    38      0     0         0
## 10 Voss_2010  10                     5    20      1     0         0
## # ... with 630 more rows, and 3 more variables: Left_Ear_Status &lt;int&gt;,
## #   Right_Ear_Status &lt;int&gt;, Sub_Notes &lt;chr&gt;</code></pre>
<p>Let’s explore the <code>Measurements</code> table.</p>
<pre class="r"><code>Measurements %&gt;% summarise(total = n())
## # Source:   lazy query [?? x 1]
## # Database: mysql 5.5.58-0ubuntu0.14.04.1-log [waiuser@scidb.smith.edu:/wai]
##    total
##    &lt;dbl&gt;
## 1 286774</code></pre>
<p>There are more than a quarter million observations.</p>
<p>In the next step, we will download the data from a given subject for a specific study, in this case a paper by Rosowski et al (2012) entitled <a href="https://www.ncbi.nlm.nih.gov/pubmed/21857517">“Ear-canal reflectance, umbo velocity, and tympanometry in normal-hearing adults”</a>.</p>
<p>Arbitrarily we choose to collect data from subject number three.</p>
<pre class="r"><code>onesubj &lt;- 
  Measurements %&gt;% 
  filter(Identifier == &quot;Rosowski_2012&quot;, Sub_Number == 3) %&gt;%
  collect %&gt;%
  mutate(SessionNum = as.factor(Session))
head(onesubj)
## # A tibble: 6 x 12
##   Identifier Sub_Number Session Left_Ear   MEP Instrument  Freq Absorbance
##   &lt;chr&gt;           &lt;int&gt;   &lt;int&gt;    &lt;int&gt; &lt;dbl&gt;      &lt;int&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1 Rosowski_~          3       1        1    NA          1  211.     0.0852
## 2 Rosowski_~          3       1        1    NA          1  234.     0.0903
## 3 Rosowski_~          3       1        1    NA          1  258.     0.112 
## 4 Rosowski_~          3       1        1    NA          1  281.     0.103 
## 5 Rosowski_~          3       1        1    NA          1  305.     0.129 
## 6 Rosowski_~          3       1        1    NA          1  328.     0.136 
## # ... with 4 more variables: Zmag &lt;dbl&gt;, Zang &lt;dbl&gt;, Canal_Area &lt;dbl&gt;,
## #   SessionNum &lt;fct&gt;</code></pre>
<p>Finally we can display the results of the measurements as a function of frequency and which ear (left or right) that was used.</p>
<pre class="r"><code>onesubj &lt;- mutate(onesubj, Ear = ifelse(Left_Ear == 1, &quot;Left&quot;, &quot;Right&quot;))
ggplot(onesubj, aes(x = Freq, y = Absorbance)) + geom_point() +
  aes(colour = Ear) + scale_x_log10() + labs(title=&quot;Absorbance by ear Rosowski subject 3&quot;)</code></pre>
<p><img src="/post/2019_06_19_SQL/sql_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>In summary, while SQL is a powerful tool, there are straightforward ways to integrate existing databases into analyses using a small number of commands. Particularly if instructors use <a href="https://teachdatascience.com/rmarkdown">RMarkdown</a>, data ingestation can be scaffolded with students able to modify and augment code that is provided to them.</p>
<p>We note that a number of relational database systems exist, including MySQL (illustrated here), PostgreSQL, and SQLite. More information about databases within R can be found in the CRAN <a href="https://cran.r-project.org/web/views/Databases.html">Databases with R</a> Task View.</p>
<p>Setting up and managing a database is a topic for a different day: here we focused on how SQL can be used within R to access data in a flexible and powerful manner.</p>
<div id="learn-more" class="section level3">
<h3>Learn more</h3>
<ul>
<li><a href="https://chance.amstat.org/2015/04/setting-the-stage/" class="uri">https://chance.amstat.org/2015/04/setting-the-stage/</a> (Setting the stage for data technologies)</li>
<li><a href="https://www.w3schools.com/sql/sql_intro.asp" class="uri">https://www.w3schools.com/sql/sql_intro.asp</a> (Intro to SQL)</li>
<li><a href="http://www.science.smith.edu/wai-database/home/about/" class="uri">http://www.science.smith.edu/wai-database/home/about/</a> (WAI SQL Database)</li>
<li><a href="https://cran.r-project.org/web/views/Databases.html" class="uri">https://cran.r-project.org/web/views/Databases.html</a> (CRAN Task View on Databases with R)</li>
<li><a href="https://db.rstudio.com" class="uri">https://db.rstudio.com</a> (RStudio Database resources)</li>
<li><a href="https://dbplyr.tidyverse.org/articles/dbplyr.html" class="uri">https://dbplyr.tidyverse.org/articles/dbplyr.html</a> (dbplyr package)</li>
</ul>
</div>
<div id="about-this-blog" class="section level3">
<h3>About this blog</h3>
<p>Each day during the summer of 2019 we intend to add a new entry to this blog on a given topic of interest to educators teaching data science and statistics courses. Each entry is intended to provide a short overview of why it is interesting and how it can be applied to teaching. We anticipate that these introductory pieces can be digested daily in 20 or 30 minute chunks that will leave you in a position to decide whether to explore more or integrate the material into your own classes. By following along for the summer, we hope that you will develop a clearer sense for the fast moving landscape of data science. Sign up for emails at <a href="https://groups.google.com/forum/#!forum/teach-data-science" class="uri">https://groups.google.com/forum/#!forum/teach-data-science</a> (you must be logged into Google to sign up).</p>
<p>We always welcome comments on entries and suggestions for new ones.</p>
</div>
</div>
